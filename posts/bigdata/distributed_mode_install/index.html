<!doctype html>

<html lang="en">

<head>
  <title>하둡(Hadoop) 가상 분산 모드 설치 - Bigdata Engineer &amp; Analyst Story</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="Kiera: A Hugo theme for creative and technical writing." />
<meta name="author" content="Sungwoon Yoon" /><meta property="og:title" content="하둡(Hadoop) 가상 분산 모드 설치" />
<meta property="og:description" content="사전 작업  레파지토리 최신화(패키지들의 새로운 버젼이 있는지 확인하고 최신 버전으로 업그래이드) sudo apt-get update sudo apt-get upgrade  Java 설치 Java 설치 참조 링크
MariaDB MariaDB 설치  sudo apt-get install -y mariadb-server  mysql 사용자 확인  cat /etc/passwd 를 수행해 mysql 유져를 확인합니다." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ynebula.github.io/posts/bigdata/distributed_mode_install/" />
<meta property="article:published_time" content="2020-11-16T11:39:12+09:00" />
<meta property="article:modified_time" content="2020-11-16T11:39:12+09:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="하둡(Hadoop) 가상 분산 모드 설치"/>
<meta name="twitter:description" content="사전 작업  레파지토리 최신화(패키지들의 새로운 버젼이 있는지 확인하고 최신 버전으로 업그래이드) sudo apt-get update sudo apt-get upgrade  Java 설치 Java 설치 참조 링크
MariaDB MariaDB 설치  sudo apt-get install -y mariadb-server  mysql 사용자 확인  cat /etc/passwd 를 수행해 mysql 유져를 확인합니다."/>

<meta name="generator" content="Hugo 0.78.1" />
    

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://ynebula.github.io/fontawesome/css/all.min.css" />
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  
  
  <link rel="stylesheet" type="text/css" href="https://ynebula.github.io/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="https://ynebula.github.io/">Bigdata Engineer &amp; Analyst Story</a>
            </h1>

      <ul id="social-media">
             <li>
               <a href="https://www.facebook.com/username" title="Facebook">
               <i class="fab fa-facebook fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://github.com/ynebula" title="GitHub">
               <i class="fab fa-github fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://linkedin.com/in/%EC%84%B1%EC%9A%B4-%EC%9C%A4-a9bb30135/" title="LinkedIn">
               <i class="fab fa-linkedin fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://www.instagram.com/sungwoon.yoon" title="Instagram">
               <i class="fab fa-instagram fa-lg"></i>
               </a>
             </li>
      </ul>
      
      <p><em>A Hugo theme for creative and technical writing</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="https://ynebula.github.io/tags">
                <i class="fa-li fa  fa-lg"></i><span>Tags</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://ynebula.github.io/categories">
                <i class="fa-li fa  fa-lg"></i><span>Categories</span>
            </a>
        </li>
        
    </ul>
</nav>


    <main>




<article>

    <h1>하둡(Hadoop) 가상 분산 모드 설치</h1>

    
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-11-16T11:39:12&#43;09:00">Nov 16, 2020</time>
        </li>
        
        
        <li>
            Categories:
            <em>
                
                    
                    <a href="https://ynebula.github.io/categories/bigdata">Bigdata</a>
                
                    , 
                    <a href="https://ynebula.github.io/categories/hadoop">Hadoop</a>
                
            </em>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="https://ynebula.github.io/tags/bigdata">#Bigdata</a>
                
                    , 
                    <a href="https://ynebula.github.io/tags/hadoop">#Hadoop</a>
                
                    , 
                    <a href="https://ynebula.github.io/tags/install">#Install</a>
                
            </em>
        </li>
        

        <li>3 minutes read</li>
    </ul>
</aside>

    

    
<div class="featured_image">
    <a href="https://ynebula.github.io/posts/bigdata/distributed_mode_install/" title="하둡(Hadoop) 가상 분산 모드 설치">
        <img src="">
    </a>
</div>



    <h3 id="사전-작업">사전 작업</h3>
<ul>
<li>레파지토리 최신화(패키지들의 새로운 버젼이 있는지 확인하고 최신 버전으로 업그래이드)</li>
<li>sudo apt-get update</li>
<li>sudo apt-get upgrade</li>
</ul>
<h3 id="java-설치">Java 설치</h3>
<p><a href="https://ynebula.github.io/posts/java/java8_install_on_ubuntu/">Java 설치 참조 링크</a></p>
<h3 id="mariadb">MariaDB</h3>
<h4 id="mariadb-설치">MariaDB 설치</h4>
<ul>
<li>sudo apt-get install -y mariadb-server</li>
</ul>
<h4 id="mysql-사용자-확인">mysql 사용자 확인</h4>
<ul>
<li>cat /etc/passwd 를 수행해 mysql 유져를 확인합니다.</li>
</ul>
<h4 id="mariadb-접속">MariaDB 접속</h4>
<ul>
<li>Unix Socket 방식으로 DB에 접속합니다.</li>
<li>sudo mysql</li>
</ul>
<h4 id="기타">기타</h4>
<h4 id="db-재시작-명령어">DB 재시작 명령어</h4>
<ul>
<li>service mysql restart</li>
<li>/etc/init.d/mysql restart</li>
<li>mysql.server restart</li>
</ul>
<h4 id="utf8mb4-인코딩-확인">utf8mb4 인코딩 확인</h4>
<ul>
<li>참고자료: <a href="https://blog.lael.be/post/917">utf8mb4 언어셋 소개 및 표현범위</a></li>
<li>show variables like &lsquo;c%';</li>
</ul>
<h4 id="서비스-확인">서비스 확인</h4>
<ul>
<li>sudo service &ndash;status-all |grep mysql</li>
</ul>
<h4 id="인증방법-unix-socket-방식으로-변경">인증방법 Unix Socket 방식으로 변경</h4>
<ul>
<li>원문: <a href="https://mariadb.org/authentication-in-mariadb-10-4/">Authentication from MariaDB 10.4</a></li>
<li>MariaDB 는 10.0 부터 인증 방식을 Unix Socket방식으로 변경했습니다. Unix Socket방식은 mysql 사용자와, 시스템 사용자를 일치시키는 방식입니다. 예전 인증방법은 두 root가 분리되어 있을 때는, mysql 사용자 root 를 명시하고 로그인 했습니다.
<ul>
<li>$ mysql -u root -p</li>
</ul>
</li>
<li>Unix Socket 방식은 이렇다. sudo 로서 root 권한이 있다는 사실만 증명하면, mysql 에선 다른 인증을 하지 않습니다.
<ul>
<li>$ sudo mysql</li>
</ul>
</li>
<li>만약, Unix Socket 을 사용하여, mysql 이라는 사용자로 mysql에 접근하려면 다음 명령어를 사용해야 합니다.
<ul>
<li>$ sudo -u mysql mysql -u mysql</li>
</ul>
</li>
</ul>
<h3 id="하둡">하둡</h3>
<p>버전: 2.9.2</p>
<h4 id="사전작업">사전작업</h4>
<ul>
<li>키젠 설정
<ul>
<li>hadoop 계정에 해줘야 함</li>
<li>ssh-keygen -t rsa</li>
<li>cat ~/.ssh/id_rsa.pub &raquo; ~/.ssh/authorized_keys</li>
<li>chmod 0660 ~/.ssh/authorized_keys</li>
</ul>
</li>
<li>SSH 서버 설치
<ul>
<li>sudo apt-get install openssh-server</li>
</ul>
</li>
</ul>
<h4 id="바이너리-파일-다운로드-및-설치">바이너리 파일 다운로드 및 설치</h4>
<ul>
<li><a href="https://hadoop.apache.org/releases.html">하둡 다운로드 링크</a></li>
<li>위치변경: mv hadoop-2.9.2 /usr/local/hadoop-2.9.2</li>
<li>소유권한 변경: sudo chown -R hadoop:hadoop hadoop-2.9.2/</li>
<li>심볼링크: sudo ln -s /usr/local/hadoop-2.9.2 /usr/local/hadoop</li>
</ul>
<h4 id="bashrc-변경">.bashrc 변경</h4>
<ul>
<li>JAVA_HOME=/usr/java/default</li>
<li>HADOOP_HOME=/usr/local/hadoop</li>
<li>PATH=$PATH:$HADOOP_HOME/bin</li>
</ul>
<h4 id="hadoop-envsh-수정">hadoop-env.sh 수정</h4>
<ul>
<li>export JAVA_HOME=/usr/java/default</li>
<li>export HADOOP_PID_DIR=/usr/local/hadoop/pids</li>
</ul>
<h4 id="masters-slaves-수정">masters, slaves 수정</h4>
<ul>
<li>네임노드 HA를 구성할 경우 스탠바이 네임노드가 보조네임노드의 기능을 대체한다. 하지만 가상 분산 모드로는 네임노드 HA를 구성할 수 없기 때문에 보조네임노드를 반드시 실행해야 한다. 또한 slaves 파일에는 데이터노드 호스트 목록을 설정해야 한다. 가상 분산 모드에서는 다음과 같이 설정한다. vi에디터로 masters 파일을 생성하고 localhost를 기입하고 저장합니다. slaves파일을 생성하고 데이터노드 호스트 목록을 기입하고 저장합니다.</li>
<li>masters -&gt; localhost</li>
<li>slaves -&gt; datanode01, datanode02</li>
</ul>
<h4 id="하둡2-수행">하둡2 수행</h4>
<ul>
<li>네임노드를 초기화하고 모든 데몬을 수행합니다.
<ul>
<li>/usr/local/hadoop/bin/hdfs namenode -format</li>
<li>/usr/local/hadoop/sbin/start-all.sh (deprecated 예정)</li>
<li>/usr/local/hadoop/sbin/stop-all.sh (deprecated 예정)</li>
<li>DFS 시작 /usr/local/hadoop/sbin/start-dfs.sh</li>
<li>얀 시작 /usr/local/hadoop/sbin/start-yarn.sh</li>
<li>맵리듀스 히스토리 서버 시작 /usr/local/hadoop/sbin/mr-jobhistory-daemon.sh start historyserver</li>
<li>웹프록시 서버 시작 /usr/local/hadoop/sbin/yarn-daemon.sh start proxyserver</li>
<li>DFS 종료 /usr/local/hadoop/sbin/stop-dfs.sh</li>
<li>얀 종료 /usr/local/hadoop/sbin/stop-yarn.sh</li>
<li>맵리듀스 히스토리 서버 종료 /usr/local/hadoop/sbin/mr-jobhistory-daemon.sh stop historyserver</li>
</ul>
</li>
</ul>
<h4 id="hdfsyarn-화면-접속">HDFS/Yarn 화면 접속</h4>
<ul>
<li>http://127.0.0.1:50070</li>
<li>http://127.0.0.1:8088</li>
</ul>
<h4 id="예제-실행">예제 실행</h4>
<ul>
<li>HDFS에 파일을 저장하고 얀을 기반으로 맵리듀스 잡을 실행해 보겠습니다.
<ul>
<li>hadoop-env.sh를 HDFS에 저장</li>
<li>./hdfs dfs -mkdir /user</li>
<li>./hdfs dfs -mkdir /user/hadoop</li>
<li>./hdfs dfs -mkdir /user/hadoop/conf</li>
<li>./hdfs dfs -put /usr/local/hadoop/etc/hadoop/hadoop-env.sh /user/hadoop/conf/</li>
<li>./hdfs dfs -ls /user/hadoop/conf/</li>
</ul>
</li>
<li>WordCount 실행
<ul>
<li>./yarn jar /usr/local/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.9.2.jar wordcount /user/hadoop/conf /user/hadoop/output</li>
<li>./hdfs dfs -cat /user/hadoop/output/part-r-00000</li>
</ul>
</li>
</ul>
<h4 id="비고">비고</h4>
<h4 id="에러1">에러1</h4>
<ul>
<li>메시지 0.0.0.0: ssh: connect to host 0.0.0.0 port 22: Connection refused
localhost: ssh: connect to host localhost port 22: Connection refused</li>
<li>원인 ssh 서버가 설치돼 있지 않아 발생함</li>
<li>해결 openssh-server 설치</li>
</ul>
<h4 id="에러2">에러2</h4>
<ul>
<li>cat: /usr/local/hadoop/slaves: No such file or directory
cat: /usr/local/hadoop/slaves: No such file or directory
Starting secondary namenodes [0.0.0.0]
The authenticity of host &lsquo;0.0.0.0 (0.0.0.0)&rsquo; can&rsquo;t be established.
ECDSA key fingerprint is SHA256:kXhOQgozNkCxUEeojqJ/4rb9Cx7lmU4yDuEgT2Aw5YQ.</li>
<li>원인</li>
<li>해결 rsa 키 생성</li>
</ul>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://ynebula.github.io/posts/hugo/hugo-install-markdown/"><i class="fa fa-chevron-circle-left"></i> Hugo 설치(Install) &amp; 마크다운(Markdown)</a>
        </li>
        
        
        <li>
            <a href="https://ynebula.github.io/posts/java/java8_install_on_ubuntu/">Java8 설치 <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
  
    
    
        <section class="comments-block">
      <button id="show-comments" style="display: none;"><i class="fa fa-comments"></i> Add/View Comments</button>
</section>

<section id="disqus_thread"></section>

<script>
      (function () {
            
            
            if (window.location.hostname == "localhost")
                  return;

            var disqus_loaded = false;
            var disqus_shortname = 'myShortName';
            var disqus_button = document.getElementById("show-comments");

            var disqus_autoload =  null ;
            var disable_comment =  null ;

            if (disable_comment)
                  return;

            disqus_button.style.display = "";

            if (disqus_autoload){
                  disqus();
            }else{
                  disqus_button.addEventListener("click", disqus, false);
            }

            function disqus() {

                  if (!disqus_loaded) {
                        disqus_loaded = true;

                        var e = document.createElement("script");
                        e.type = "text/javascript";
                        e.async = true;
                        e.src = "//" + disqus_shortname + ".disqus.com/embed.js";
                        (document.getElementsByTagName("head")[0] ||
                              document.getElementsByTagName("body")[0])
                        .appendChild(e);

                        
                        document.getElementById("show-comments").style.display = "none";
                  }
            }

            
            var hash = window.location.hash.substr(1);
            if (hash.length > 8) {
                  if (hash.substring(0, 8) == "comment-") {
                        disqus();
                  }
            }

            
            if (/bot|google|baidu|bing|msn|duckduckgo|slurp|yandex/i.test(navigator.userAgent)) {
                  disqus();
            }
      })();
</script>

    
  





</main>
    <footer>
        <h6>Copyright © 2020 - Sungwoon Yoon |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://ynebula.github.io/index.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="https://ynebula.github.io/js/scripts.js"></script>


</body>

</html>

